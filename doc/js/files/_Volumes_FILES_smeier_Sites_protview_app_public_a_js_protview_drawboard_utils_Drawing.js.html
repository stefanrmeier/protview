<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>&#x2F;Volumes&#x2F;FILES&#x2F;smeier&#x2F;Sites&#x2F;protview&#x2F;app&#x2F;public&#x2F;a&#x2F;js&#x2F;protview&#x2F;drawboard&#x2F;utils&#x2F;Drawing.js</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.5.1&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.5.1&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="..&#x2F;assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/Core.View.html">Core.View</a></li>
            
                <li><a href="..&#x2F;classes/DrawBoard.Controller.DrawBoardController.html">DrawBoard.Controller.DrawBoardController</a></li>
            
                <li><a href="..&#x2F;classes/DrawBoard.Model.Representation.html">DrawBoard.Model.Representation</a></li>
            
                <li><a href="..&#x2F;classes/DrawBoard.Model.StructuralGeometry.html">DrawBoard.Model.StructuralGeometry</a></li>
            
                <li><a href="..&#x2F;classes/DrawBoard.Model.StructuralGeometryCollection.html">DrawBoard.Model.StructuralGeometryCollection</a></li>
            
                <li><a href="..&#x2F;classes/DrawBoard.Module.html">DrawBoard.Module</a></li>
            
                <li><a href="..&#x2F;classes/Structure.Controller.MainController.html">Structure.Controller.MainController</a></li>
            
                <li><a href="..&#x2F;classes/Structure.Controller.PeptideController.html">Structure.Controller.PeptideController</a></li>
            
                <li><a href="..&#x2F;classes/Structure.Controller.ProteinController.html">Structure.Controller.ProteinController</a></li>
            
                <li><a href="..&#x2F;classes/Structure.Model.Peptide.html">Structure.Model.Peptide</a></li>
            
                <li><a href="..&#x2F;classes/Structure.Model.Protein.html">Structure.Model.Protein</a></li>
            
                <li><a href="..&#x2F;classes/Structure.Module.html">Structure.Module</a></li>
            
                <li><a href="..&#x2F;classes/Structure.View.NewProteinView.html">Structure.View.NewProteinView</a></li>
            
                <li><a href="..&#x2F;classes/Structure.View.PeptideView.html">Structure.View.PeptideView</a></li>
            
                <li><a href="..&#x2F;classes/Structure.View.ProteinView.html">Structure.View.ProteinView</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="..&#x2F;modules/Application.html">Application</a></li>
            
                <li><a href="..&#x2F;modules/Core.html">Core</a></li>
            
                <li><a href="..&#x2F;modules/DrawBoard.html">DrawBoard</a></li>
            
                <li><a href="..&#x2F;modules/Structure.html">Structure</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: &#x2F;Volumes&#x2F;FILES&#x2F;smeier&#x2F;Sites&#x2F;protview&#x2F;app&#x2F;public&#x2F;a&#x2F;js&#x2F;protview&#x2F;drawboard&#x2F;utils&#x2F;Drawing.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
ProtView.DrawBoard.Utils.Drawing = Class.extend( {
	svg : null,
	&#x2F;&#x2F;fixme, this attribute should not be at this place
	aaSize : 10,
	init: function(svg) {
		this.svg = svg;
	},
	paint : function(collection, params, callback, context) {

		var self = this;
		
	    if (params.dimension != null) {
	    	var dimension = params.dimension;
	    	var minX = dimension.minX,
	    	maxX = dimension.maxX,
	    	minY = dimension.minY,
	    	maxY = dimension.maxY;
	    	var width = maxX - minX,
	    	height = maxY - minY;
	    	
	    	if (params.membrane != null) {
	    		var membrane = params.membrane;
	    		self.drawMembrane(minX, maxX, membrane.minY, membrane.maxY);
	    	}

	    	self.svg.configure({viewBox: minX + &#x27; &#x27; + minY + &#x27; &#x27; + width + &#x27; &#x27; + height});
	    }
		
	    for (var i = 0, len = collection.length; i &lt; len; i++) {
	        var geometry = collection.at(i);

	        var coordinates = geometry.get(&#x27;coordinates&#x27;);
			var labels = geometry.get(&#x27;labels&#x27;);
			
			var geometry_id = geometry.id;

			for (var j = 0, lenC = coordinates.length; j &lt; lenC; j++) {
				var coordinate = coordinates[j];
				var label = labels[j].split(&quot;-&quot;);
				var x = coordinate.x;
				var y = coordinate.y;
				var id = coordinate.id;
				
				var type = label[0];
				var pos = label[1];
					
				self.drawAminoAcid(x, y, self.aaSize, type, pos, geometry_id + &#x27;-&#x27; + id);
			}
		}
	    self.addDragSupport($(&#x27;.dragsupport&#x27;), callback, context);
	},
	clearAll : function() {
		this.svg.clear();
	},
	&#x2F;**
	 * Draws an amino acid element &lt;group&gt; &lt;circle&gt; &lt;text&gt;Label&lt;&#x2F;text&gt;
	 * &lt;text&gt;Position&lt;&#x2F;text&gt; &lt;group&gt;
	 * 
	 * @param svg
	 * @param x
	 * @param y
	 * @param size
	 * @param label
	 * @param pos
	 *&#x2F;
	drawAminoAcid : function (x, y, size, label, pos, id) {
		var svg = this.svg;
		var g = svg.group({
			id : &#x27;aa-&#x27; + id,
			class_: &#x27;aa dragsupport&#x27;,
			&#x2F;*
			 * bug fix for translation start position bug as draggable is based on
			 * html dom
			 *&#x2F;
			style : &#x27;position: relative !important; left: &#x27; + x + &#x27;px; top:&#x27; + y + &#x27;px;&#x27;,
			transform: &#x27;translate(&#x27; + x + &#x27;,&#x27; + y + &#x27;)&#x27;
		});

		svg.circle(g, 0, 0, size, {
			id: &#x27;aa-&#x27; + id + &#x27;-cercle&#x27;
		});

		svg.text(g, -4, 0, label, {
			id : &#x27;aa-&#x27; + id + &#x27;-text&#x27;
		});
		svg.text(g, -4, 6, pos, {
			id : &#x27;aa-&#x27; + id + &#x27;-seq_num&#x27;,
			class_: &#x27;seq_num&#x27;
		});
	},
	&#x2F;**
	 * Draws the membrane of the current protein
	 * 
	 * @param minX
	 * @param maxX
	 * @param minY
	 * @param maxY
	 *&#x2F;
	drawMembrane : function(minX, maxX, minY, maxY) {
		var svg = this.svg;
		var g = svg.group({
			id : &#x27;membrane&#x27;,
			&#x2F;*class_ : &#x27;dragsupport&#x27;,
			style : &#x27;position: relative; left: &#x27; + minX + &#x27;px; top:&#x27; + minY + &#x27;px;&#x27;,*&#x2F;
		});

		svg.line(g, minX, minY, maxX, minY, {strokeWidth: 2, id : &#x27;membrane-bottom&#x27;});
		svg.line(g, minX, ((maxY+minY)&#x2F;2), maxX, ((maxY+minY)&#x2F;2), {strokeWidth: (maxY-minY), id : &#x27;membrane-center&#x27;});
		svg.line(g, minX, maxY, maxX, maxY, {strokeWidth: 1, id : &#x27;membrane-top&#x27;});
	},

	&#x2F;**
	 * Adds drag and drop support to an SVG Element
	 * 
	 * @param svgElement
	 *&#x2F;
	addDragSupport : function (svgElement, callback, context) {
		var self = this;
		if (svgElement != null) {
			svgElement
			  	.draggable({
				  &#x2F;&#x2F; sets cursor position relative to elements size
				  cursorAt: { 
					  position: &#x27;absolute !important&#x27;,
					  top: self.aaSize, 
					  left: self.aaSize 
					  }
			  	})
			  	.bind(&#x27;drag&#x27;, function(event, ui){
			  		&#x2F;&#x2F; update coordinates manually, since top&#x2F;left style props don&#x27;t
					&#x2F;&#x2F; work on SVG
			  		if (callback != null)
			  			callback(event.target, ui.position.left, ui.position.top, context);
			  		event.target.setAttribute(&#x27;transform&#x27;, &#x27;translate(&#x27; + ui.position.left + &#x27;,&#x27; + ui.position.top + &#x27;)&#x27;);
			  	})
			  	&#x2F;&#x2F;this event should not be handled here
				.bind(&#x27;mousedown&#x27;, function (event) {
	                var rightclick = false;
                    if (!event) event = window.event;
                    if (event.which) rightclick = (event.which == 3);
                    else if (event.button) rightclick = (event.button == 2);
	                
	                if (rightclick) {
	                    var scrollTop = $(window).scrollTop();
	                    var scrollLeft = $(window).scrollLeft();
	                    var contextMenu = $(&quot;#drawBoardContextMenu&quot;).jqxMenu({ width: &#x27;120px&#x27;, height: &#x27;140px&#x27;, autoOpenPopup: false, mode: &#x27;popup&#x27;, theme: Application.THEME });
	                    contextMenu.jqxMenu(&#x27;open&#x27;, parseInt(event.clientX) + 5 + scrollLeft, parseInt(event.clientY) + 5 + scrollTop);
	                    return false;
	                }
	            });
		}
	},
});

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
